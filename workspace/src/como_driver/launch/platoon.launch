<!-- Sleiman Safaoui
    July 30, 2018
  -->

<!-- Launch file to start the line follower and its corresponding higher-level controller -->

<launch>

    <!-- SYSTEM MODEL -->
    <!-- vehicle parameters -->
    <param name="L_a" type="double" value="0.125" />
    <param name="L_b" type="double" value="0.125" />
    <!-- control parameters -->
    <param name="input_gain" type="double" value="0.3" />
    
    <!-- ARDUINO -->
    <node pkg="rosserial_python" type="serial_node.py" name="arduino_node" >
        <param name="port" value="/dev/controller/nano" />
    </node>

	<!-- LOW-LEVEL CONTROLLER -->
	<node pkg="barc" type="controller_low_level.py" name="low_level_controller" output="screen" />
    
    
    
    
    <!-- intermediate level controller-->
    
	<!-- Start cam_bridge, img_preprocessing, and process_line -->
	<include file="$(find image_processing)/launch/process_line.launch" />

	<!-- april tag detector -->
	<node pkg="image_processing" type = "april_tag_detector.py" name = "april_tag_detector" output = "screen" respawn = "true">
		<rosparam command="load" file="$(find image_processing)/config/april_tag_detector_params.yml"/>
	</node>
	
	<!-- INTERMEDIATE-LEVEL CONTROLLER (line_follower) -->
	<node pkg="controllers" type="line_follower.py" name="line_follower" output="screen"/>
	
    <!-- higher level controller-->
    
	<node pkg="como_driver" type="platoon.py" name="platoon" output="screen" respawn = "true">
		<rosparam command="load" file="$(find como_driver)/config/platoon_params.yml"/>
	</node>
</launch>
